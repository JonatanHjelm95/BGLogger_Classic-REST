(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1055:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(421),s=n.n(i),o=(n(432),n(433),n(32)),l=n(33),c=n(40),u=n(39),d=n(41),m=n(243),h=n(24),f=n(49),p=n.n(f),v=n(99),b=n(80),y=n(426),g=new(function(){function e(){var t=this;Object(o.a)(this,e),this.startAnalyzation=function(){var e=Object(v.a)(p.a.mark(function e(n,a){var r,i,s,o;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("data",a),i=t.makeOptions("POST",r),e.next=5,fetch("api/analyze/upload/"+n,i);case 5:return s=e.sent,e.next=8,s.json();case 8:if(o=e.sent,s.ok){e.next=11;break}throw{status:s.status,fullError:o};case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}return Object(l.a)(e,[{key:"makeOptions",value:function(e,t){var n={method:e,headers:{"Content-type":"multipart/form-data"}};return t&&(n.body=t),n}}]),e}()),E=n(423),k=n.n(E),O=n(155),j=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={division:n.props.division,data:{labels:n.props.Y,datasets:[{label:n.props.chartname,data:n.props.X}]}},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"setInitialStartDate",value:function(){var e=(new Date).getTime(),t=new Date(e);return t=t.setMonth(t.getMonth()-1)}},{key:"componentDidUpdate",value:function(e){}},{key:"convertTimestampToDatetime",value:function(e){var t=parseInt(e),n=new Date(t),a=this.addZero(n.getUTCHours()),r=this.addZero(n.getUTCMinutes());return n.getUTCDate()+"/"+(n.getUTCMonth()+1)+"/"+n.getUTCFullYear()+"-"+a+":"+r+" UTC"}},{key:"addZero",value:function(e){return e<10&&(e="0"+e),e}},{key:"setChartData",value:function(){var e,t=this,n=this.state.label1;n=n.sort(),e=this.state.showOrders?{labels:n.map(function(e){return t.convertTimestampToDatetime(parseInt(e))}),datasets:[{type:"bubble",label:"BUYS",backgroundColor:"green",data:this.state.buys},{type:"bubble",label:"SELLS",backgroundColor:"red",data:this.state.sells},{label:this.props.cryptoName,fill:"true",pointRadius:0,borderColor:"#473BF0",borderWidth:1,pointBackgroundColor:"white",data:this.state.JSONdata.map(function(e){return parseFloat(e[2]).toFixed(2)})}]}:{labels:n.map(function(e){return t.convertTimestampToDatetime(parseInt(e))}),datasets:[{label:this.props.cryptoName,fill:"true",pointRadius:0,borderColor:"#473BF0",borderWidth:1,pointBackgroundColor:"white",data:this.state.JSONdata.map(function(e){return parseFloat(e[2]).toFixed(2)})}]},this.setState({data:e,loading:!1})}},{key:"changeInterval",value:function(e){this.setState({interval:e.target.value}),this.getChartData()}},{key:"render",value:function(){var e=window.innerWidth-20,t=parseInt(e/this.state.division);return r.a.createElement("div",{className:"chart-container"},r.a.createElement(O.a,{height:150,width:t,options:{},data:this.state.data}))}}]),t}(a.Component),w=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={endOfCombat:n.props.data[1].data,startOfCombat:n.props.data[0].data,ic:[],timeData:n.props.data,data:{labels:[0],datasets:[{label:"Timeline",data:[]}]}},n.createTimeline(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){console.log(this.state.timeData)}},{key:"getObjSize",value:function(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}},{key:"createTimeline",value:function(){var e=this.state.endOfCombat[this.getObjSize(this.state.endOfCombat)-1];this.setState({data:{labels:this.createTimeArray(e),datasets:[{label:"Timeline",data:this.createTimeData(e)}]}})}},{key:"createTimeData",value:function(e){this.state.endOfCombat,this.state.startOfCombat;for(var t=[],n=!1,a=0;a<e;a++){for(;0<this.getObjSize(this.state.endOfCombat);a++)n||(n=a>=this.state.startOfCombat[0]&&a<this.state.endOfCombat[0]);n?t.push[1]:t.push[0]}return console.log(t.length,t),t}},{key:"createTimeArray",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}},{key:"componentWillReceiveProps",value:function(e){this.state.ooc!=e.ooc&&this.setState({ooc:e.ooc}),this.state.ic!=e.ic&&this.setState({ic:e.ic}),this.state.timeData!=e.data&&this.setState({timeData:e.data})}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"setInitialStartDate",value:function(){var e=(new Date).getTime(),t=new Date(e);return t=t.setMonth(t.getMonth()-1)}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){return r.a.createElement("div",{className:"chart-container"},r.a.createElement(O.a,{height:80,width:window.innerWidth-20,options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{ticks:{display:!0}}]}},data:this.state.data}))}}]),t}(a.Component),S=(r.a.Component,function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).addMessage=function(e){var t=e.sender,n=e.text;return console.log("".concat(t," sends ").concat(n))},n.addRow=function(e){var t=e.sender,a=e.text,r={sender:t,text:JSON.parse(a)};n.state.stream;console.log(r.text);var i=n.state.stream;i.unshift(r),n.setState({stream:i}),console.log(n.state.stream),n.props.finish()},n.state={finish:n.props.finish,stream:n.props.stream,initiator:n.props.initiator},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.initiator!=this.state.initiator&&this.setState({initiator:e.initiator}),e.stream!=this.state.stream&&this.setState({stream:e.stream})}},{key:"componentDidMount",value:function(){var e=this;this.socket=k.a.open("http://localhost:8080/jpareststarter/cettia?token=log");var t=function(t){return e.addMessage({sender:"system",text:t})};this.socket.on("message",function(t){return function(t){return e.addRow(t)}(t)}),this.socket.on("connecting",function(){return t("The socket starts a connection.")}),this.socket.on("open",function(){return t("The socket establishes a connection.")}),this.socket.on("close",function(){return t("All transports failed to connect or the connection was disconnected.")}),this.socket.on("waiting",function(e){return t("The socket will reconnect after ".concat(e," ms"))}),this.socket.once("open",function(){return setInterval(function(){return e.socket.send("message",{text:"A message - ".concat(Date.now())})},5e3)})}},{key:"createActionAnalysis",value:function(e){var t=this,n=(e.data,e.plots);if(console.log(n),this.getObjSize(n)>0)return r.a.createElement("div",null,r.a.createElement("tr",null,n.map(function(e){return r.a.createElement("td",null,t.createPlot(e,3))})))}},{key:"createDamageAnalysis",value:function(e){var t=this,n=(e.data,e.plots);if(this.getObjSize(n)>0)return r.a.createElement("div",null,r.a.createElement("tr",null,n.map(function(e){return r.a.createElement("td",null,t.createPlot(e,4))})))}},{key:"createDPSAnalysis",value:function(e){var t=this,n=(e.data,e.plots);if(this.getObjSize(n)>0)return r.a.createElement("div",null,r.a.createElement("tr",null,n.map(function(e){return r.a.createElement("td",null,t.createPlot(e,2))})))}},{key:"createDPSAnalysisTable",value:function(e){var t=e.data,n=e.Name.toString().split(",");return r.a.createElement("td",null,r.a.createElement("tr",null,r.a.createElement("td",null,n[0]),r.a.createElement("td",null,t[0])),r.a.createElement("tr",null,r.a.createElement("td",null,n[1]),r.a.createElement("td",null,t[1])),r.a.createElement("tr",null,r.a.createElement("td",null,n[2]),r.a.createElement("td",null,t[2])))}},{key:"getObjSize",value:function(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}},{key:"createDataline",value:function(e){e.map()}},{key:"createPlot",value:function(e,t){return r.a.createElement(j,{chartname:e.Name,X:e.Y,Y:e.X,division:t})}},{key:"createTimeline",value:function(e){return r.a.createElement(w,{data:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("table",{className:"tg"},r.a.createElement("thead",null,r.a.createElement("th",null,this.state.initiator)),r.a.createElement("tbody",null,this.state.stream.map(function(e){void 0!==e.sender&&e.sender.toString().includes("Analysis.CombatTimeAnalysis")&&console.log(e.text)}),this.state.stream.map(function(t){if(void 0!==t.sender&&t.sender.toString().includes("Analysis.ActionAnalysis"))return console.log(t.text),r.a.createElement("div",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Action Analysis")),r.a.createElement("tr",null,r.a.createElement("td",null,e.createActionAnalysis(t.text))))}),this.state.stream.map(function(t){if(void 0!==t.sender&&t.sender.toString().includes("Analysis.DamageAnalysis"))return console.log(t.text),r.a.createElement("div",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Damage Analysis")),r.a.createElement("tr",null,r.a.createElement("td",null,e.createDamageAnalysis(t.text))))}),this.state.stream.map(function(t){if(void 0!==t.sender&&t.sender.toString().includes("Analysis.CombatDpsAnalysis"))return console.log(t.text.data),r.a.createElement("div",null,r.a.createElement("tr",null,r.a.createElement("th",null,"DPS Analysis"),r.a.createElement("th",null)),r.a.createElement("tr",null,r.a.createElement("td",null,e.createDPSAnalysis(t.text)),r.a.createElement("td",null,e.createDPSAnalysisTable(t.text.data[0]))))}))))}}]),t}(r.a.Component)),D=function(){return r.a.createElement("div",{className:"loader"})},A=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={validFile:!1,processed:!1,loading:!1,encodedData:"",combatLog:[],units:[],selectedUnit:"",stream:[]},n.analyze=n.analyze.bind(Object(b.a)(Object(b.a)(n))),n.finishedAnalyzing=n.finishedAnalyzing.bind(Object(b.a)(Object(b.a)(n))),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"validateFile",value:function(e){var t=e[0].path;console.log(e[0].path),"WoWCombatLog.txt"===t?this.setState({processed:!1,validFile:"WoWCombatLog.txt"===t}):console.log("invalid file"),this.processFile(e[0])}},{key:"processFile",value:function(){var e=Object(v.a)(p.a.mark(function e(t){var n,a=this;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.state.validFile&&((n=new FileReader).onload=Object(v.a)(p.a.mark(function e(){var t,r,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.result,r=t.split("\n"),i=a.getAllUnitsFromFile(t),a.setState({combatLog:r,units:i,processed:!0}),a.createUnitSelectItems();case 5:case"end":return e.stop()}},e)})),n.readAsText(t));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAllUnitsFromFile",value:function(e){for(var t=[],n=e.split("\n"),a=1;a<n.length;a++)for(var r=n[a].split(","),i=0;i<r.length;i++)r[i].includes("Player")&&r[i+1].includes&&t.push(r[i+1]);return this.filter_list(this.removeDups(t))}},{key:"filter_list",value:function(e){return e.filter(function(e){return e.includes("-")})}},{key:"createUnitSelectItems",value:function(){var e=this.state.units.map(function(e){return r.a.createElement("option",{key:e.replace('"',""),value:e.replace('"',"")},e.replace('"',"").replace('"',""))});this.setState({units:e})}},{key:"removeDups",value:function(e){var t={};return e.forEach(function(e){t[e]||(t[e]=!0)}),Object.keys(t)}},{key:"analyze",value:function(){var e=Object(v.a)(p.a.mark(function e(t,n){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0,stream:[]}),e.next=3,g.startAnalyzation(t,JSON.parse(JSON.stringify(n)));case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"changeUnit",value:function(e){e.persist(),this.setState({selectedUnit:e.target.value.replace('"',"")})}},{key:"finishedAnalyzing",value:function(){this.setState({loading:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.state.loading?r.a.createElement(D,null):r.a.createElement("div",null,r.a.createElement(y.a,{onDrop:function(t){return e.validateFile(t)}},function(e){var t=e.getRootProps,n=e.getInputProps;return r.a.createElement("section",null,r.a.createElement("div",t(),r.a.createElement("input",n()),r.a.createElement("p",null,"Drop your CombatLog.txt here, or click to browse files")))}),this.state.processed?r.a.createElement("div",null,r.a.createElement("div",{className:"unit-container"},r.a.createElement("select",{className:"unit-select",onChange:function(t){return e.changeUnit(t)}},r.a.createElement("option",{value:"",disabled:!0,selected:!0},"Select player"),this.state.units)),this.state.selectedUnit.length>0?r.a.createElement("button",{onClick:function(t){return e.analyze(e.state.selectedUnit,e.state.combatLog)}},"Analyze"):r.a.createElement("div",null)):r.a.createElement("div",null)),r.a.createElement(S,{initiator:this.state.selectedUnit,finish:this.finishedAnalyzing,stream:this.state.stream}))}}]),t}(a.Component),C=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(A,null))}}]),t}(r.a.Component),x=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(m.a,null,r.a.createElement("div",{className:"Header"},r.a.createElement("div",{className:"header-buttons"},r.a.createElement(m.b,{className:"link",to:"/",exact:!0},r.a.createElement("span",null,"Analyze")))),r.a.createElement(h.c,null,r.a.createElement(h.a,{path:"/",exact:!0,component:C}))))}}]),t}(r.a.Component);var T=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(x,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()}).catch(function(e){console.error(e.message)})},427:function(e,t,n){e.exports=n(1055)},432:function(e,t,n){},433:function(e,t,n){},474:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=474},500:function(e,t){},502:function(e,t){},524:function(e,t){},525:function(e,t){},530:function(e,t){},532:function(e,t){},541:function(e,t){},543:function(e,t){},568:function(e,t){},570:function(e,t){},571:function(e,t){},577:function(e,t){},579:function(e,t){},597:function(e,t){},600:function(e,t){},616:function(e,t){},619:function(e,t){},640:function(e,t){}},[[427,1,2]]]);
//# sourceMappingURL=main.e9838f5d.chunk.js.map