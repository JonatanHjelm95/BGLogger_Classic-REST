(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{398:function(t,e,n){t.exports=n(956)},403:function(t,e,n){},404:function(t,e,n){},462:function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=462},489:function(t,e){},491:function(t,e){},514:function(t,e){},515:function(t,e){},521:function(t,e){},523:function(t,e){},533:function(t,e){},535:function(t,e){},560:function(t,e){},562:function(t,e){},563:function(t,e){},569:function(t,e){},571:function(t,e){},589:function(t,e){},592:function(t,e){},608:function(t,e){},611:function(t,e){},632:function(t,e){},956:function(t,e,n){"use strict";n.r(e);var a=n(3),r=n.n(a),o=n(392),i=n.n(o),c=(n(403),n(404),n(48)),s=n(49),l=n(66),u=n(65),f=n(67),p=n(221),h=n(24),m=n(31),d=n.n(m),v=n(73),b=n(117),k=n(397),g=n(394),y=n.n(g),E="http://161.35.221.47/bglogger",O=new(function(){function t(){var e=this;Object(c.a)(this,t),this.startAnalyzation=function(){var t=Object(v.a)(d.a.mark(function t(n,a){var r,o,i;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.makeOptions("POST",{initiator:n,data:a}),t.next=3,fetch(E+"/api/analyze/postlog",r);case 3:return o=t.sent,t.next=6,o.json();case 6:if(i=t.sent,o.ok){t.next=9;break}throw{status:o.status,fullError:i};case 9:return t.abrupt("return",i);case 10:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),this.uploadLog=function(){var t=Object(v.a)(d.a.mark(function t(e){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:y.a.post(E+"/api/analyze/upload",e,{}).then(function(t){console.log(t.statusText)});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),this.stopAnalyzation=Object(v.a)(d.a.mark(function t(){var n,a,r;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.makeOptions("POST",!0),t.next=3,fetch("/api/backtest/stop",n);case 3:return a=t.sent,t.next=6,a.json();case 6:if(r=t.sent,a.ok){t.next=9;break}throw{status:a.status,fullError:r};case 9:return t.abrupt("return",r);case 10:case"end":return t.stop()}},t)}))}return Object(s.a)(t,[{key:"makeOptions",value:function(t,e){var n={method:t,headers:{"Content-type":"application/json",Accept:"application/json"}};return e&&(n.body=JSON.stringify(e)),n}}]),t}()),j=n(395),w=n.n(j),x=function(t){function e(t){return Object(c.a)(this,e),Object(l.a)(this,Object(u.a)(e).call(this,t))}return Object(f.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return r.a.createElement("tr",null,r.a.createElement("td",null,this.props.obj.msg),r.a.createElement("td",null,this.props.obj.api))}}]),e}(r.a.Component),F=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(l.a)(this,Object(u.a)(e).call(this,t))).addMessage=function(t){var e=t.sender,n=t.text;return console.log("".concat(e," sends ").concat(n))},n.addRow=function(t){var e=t.sender,a=t.text;console.log(a);var r={msg:a,api:e},o=(n.state.stream,n.state.stream);o.unshift(r),n.setState({stream:o})},n.state={stream:[{}],initiator:n.props.initiator},n}return Object(f.a)(e,t),Object(s.a)(e,[{key:"componentWillReceiveProps",value:function(t){t.initiator!=this.state.initiator&&this.setState({initiator:t.initiator})}},{key:"componentDidMount",value:function(){var t=this;this.socket=w.a.open("http://161.35.221.47/bglogger/cettia?token=log");var e=function(e){return t.addMessage({sender:"system",text:e})};this.socket.on("message",function(e){return function(e){return t.addRow(e)}(e)}),this.socket.on("connecting",function(){return e("The socket starts a connection.")}),this.socket.on("open",function(){return e("The socket establishes a connection.")}),this.socket.on("close",function(){return e("All transports failed to connect or the connection was disconnected.")}),this.socket.on("waiting",function(t){return e("The socket will reconnect after ".concat(t," ms"))}),this.socket.once("open",function(){return setInterval(function(){return t.socket.send("message",{text:"A message - ".concat(Date.now())})},5e3)})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Results for ",this.state.initiator),r.a.createElement("table",{className:"result-table"},r.a.createElement("thead",null,r.a.createElement("th",null,this.state.initiator),r.a.createElement("th",null,"API kaldt")),this.state.stream.map(function(t){return r.a.createElement(x,{obj:t})})))}}]),e}(r.a.Component),S=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={validFile:!1,processed:!1,loading:!1,analyzeInitiated:!1,encodedData:"",combatLog:[],units:[],selectedUnit:"",selectedFile:"",formData:null},n.analyze=n.analyze.bind(Object(b.a)(Object(b.a)(n))),n}return Object(f.a)(e,t),Object(s.a)(e,[{key:"validateFile",value:function(t){var e=t[0].path;if(console.log(t[0].path),"WoWCombatLog.txt"===e){var n=new FormData;this.setState({processed:!1,validFile:"WoWCombatLog.txt"===e,selectedFile:t[0]}),n.append("file",this.state.selectedFile),this.setState({formData:n}),console.log(this.state.formData)}else console.log("invalid file");this.processFile(t[0])}},{key:"processFile",value:function(){var t=Object(v.a)(d.a.mark(function t(e){var n,a=this;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.state.validFile&&((n=new FileReader).onload=Object(v.a)(d.a.mark(function t(){var e,r,o;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=n.result,r=e.split("\n"),o=a.getAllUnitsFromFile(e),a.setState({combatLog:r,units:o,processed:!0}),console.log(a.state.combatLog),a.createUnitSelectItems();case 6:case"end":return t.stop()}},t)})),n.readAsText(e));case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"getAllUnitsFromFile",value:function(t){for(var e=[],n=t.split("\n"),a=1;a<n.length;a++)for(var r=n[a].split(","),o=0;o<r.length;o++)r[o].includes("Player")&&r[o+1]&&e.push(r[o+1]);return this.filter_list(this.removeDups(e))}},{key:"filter_list",value:function(t){return t.filter(function(t){return t.includes("-")})}},{key:"createUnitSelectItems",value:function(){var t=this.state.units.map(function(t){return r.a.createElement("option",{key:t.replace('"',""),value:t.replace('"',"")},t.replace('"',"").replace('"',""))});this.setState({units:t})}},{key:"removeDups",value:function(t){var e={};return t.forEach(function(t){e[t]||(e[t]=!0)}),Object.keys(e)}},{key:"analyze",value:function(){var t=Object(v.a)(d.a.mark(function t(e,n){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.append("initiator",e),t.next=4,O.startAnalyzation(e,n);case 4:this.setState({analyzeInitiated:!0});case 5:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"changeUnit",value:function(t){t.persist(),this.setState({selectedUnit:t.target.value.replace('"',"")})}},{key:"render",value:function(){var t=this;return r.a.createElement("div",null,r.a.createElement(k.a,{onDrop:function(e){return t.validateFile(e)}},function(t){var e=t.getRootProps,n=t.getInputProps;return r.a.createElement("section",null,r.a.createElement("div",e(),r.a.createElement("input",n()),r.a.createElement("p",null,"Drop your CombatLog.txt here, or click to browse files")))}),this.state.processed?r.a.createElement("div",null,r.a.createElement("div",{className:"unit-container"},r.a.createElement("select",{className:"unit-select",onChange:function(e){return t.changeUnit(e)}},r.a.createElement("option",{value:"",disabled:!0,selected:!0},"Select player"),this.state.units)),this.state.selectedUnit.length>0?r.a.createElement("button",{onClick:function(e){return t.analyze(t.state.selectedUnit,t.state.formData)}},"Analyze"):r.a.createElement("div",null),this.state.analyzeInitiated?r.a.createElement(F,{initiator:this.state.selectedUnit}):r.a.createElement("div",null)):r.a.createElement("div",null))}}]),e}(a.Component),z=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={},n}return Object(f.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(S,null))}}]),e}(r.a.Component),D=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={},n}return Object(f.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(p.a,null,r.a.createElement("div",{className:"Header"},r.a.createElement("div",{className:"header-buttons"},r.a.createElement(p.b,{className:"link",to:"/",exact:!0},r.a.createElement("span",null,"Analyze")))),r.a.createElement(h.c,null,r.a.createElement(h.a,{path:"/",exact:!0,component:z}))))}}]),e}(r.a.Component);var A=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(D,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()}).catch(function(t){console.error(t.message)})}},[[398,1,2]]]);
//# sourceMappingURL=main.65614a4e.chunk.js.map